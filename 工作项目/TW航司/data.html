<!DOCTYPE html>

<html lang="zh-CN">
	


    <!-- 날짜 선택 -->
    <div class="sel_date_wrap">

        

            <!-- 날짜 선택 슬라이드 -->
            <div class="sel_date_slide swiper-container route_all route_1" id="price_slider_1">
                <ul class="swiper-wrapper">

                    <li class="lowestFarePrev" style="display:none;" data-period="P" data-route_num="1" id="beginLowestPriceList_1">
                        Previous
                    </li>
                    <li class="lowestFareNext" style="display:none;" data-period="N" data-route_num="1" id="endLowestPriceList_1">
                        Next
                    </li>

                    
                </ul>
            </div>
            <!--// 날짜 선택 슬라이드 -->
            <!-- 슬라이드 버튼 -->
            <a class="btn_slide_prev" href="#none">이전</a>
            <a class="btn_slide_next" href="#none">다음</a>
            <!--// 슬라이드 버튼 -->

        
    </div>
    <!--// 날짜 선택 -->



    <!-- 구간 리스트 -->
    <div class="section_list_wrap">


        
        


        
        

            <!-- 정렬옵션 -->
            <div class="list_opt txt_right">
            	
                <span class="select small">
                    <select name="filter_price" onchange="tripInfoSort(this);" title="시간순 가격순 1차 옵션 선택 후 2차 국가별 화페 단위 옵션 선택">
                        <option value="1">直达航班</option>
                        <option value="2">时间顺序</option>
                        <option value="3">价格顺序</option>
                    </select>
                </span>
                <span class="select small">
                    <select id="currencyList" name="filter_currency" onchange="currencyChange();" title="국가별 화폐 단위 리스트 정렬 선택 옵션을 선택하면 리스트 노출">
                        <!--<option th:each="currency:${currencyList}" th:value="${currency.baseCurr}" th:text="${currency.baseCurr}">KRW</option>-->
                    </select>
                </span>
            </div>
            <!--// 정렬옵션 -->

            <!-- 리스트 -->
            <div class="section_list" id="price_list_route_1">
                <ul>


                    
                    


                    <li class="price_list route_all route_1">
                        <a class="section_list_box" href="#none">
                            <!-- 비행 정보 -->
                            <div class="section_info">

                                <!-- 비행 정보 박스 -->
                                <div class="service_section_box">
                                    <!-- 구간 -->
                                    <button class="bul_air_info" onclick="flightOperateInfo(&#39;德威航空&#39;,&#39;737-800&#39;,&#39;N&#39;,&#39;212&#39;,&#39;TW&#39;);">TW212</button>
                                     	
                                    <!-- 이원구간인 경우, 출발날짜 표기, 2019-07-16 jebaek --> 	
                                    
                                     	
                                    <!--
                                    <button class="bul_air_info" th:text="${segmentInfo.flightIdentifierInfo.carrierCode + segmentInfo.flightIdentifierInfo.flightNumber}"
                                            th:onclick="${'flightOperateInfo('''+(segmentInfo.operatingAirlineInfo!=null?segmentInfo.operatingAirlineInfo.carrierName:'T\''way air')+''','''+segmentInfo.aircraftInfo.type+'-'+segmentInfo.aircraftInfo.version+''','''+(segmentInfo.operatingAirlineInfo!=null?'Y':'N')+''');'}">
                                    -->
                                    <!-- <button th:with="carrierCode=${segmentInfo.flightIdentifierInfo.carrierCode}"
                                        th:class="'bul_air_info' +${carrierCode eq 'TW' ? '' : (carrierCode eq 'IT' ? ' tiger' : ' eastar')}"
                                        th:text="${carrierCode + segmentInfo.flightIdentifierInfo.flightNumber}"
                                        th:onclick="${'flightOperateInfo('''+(segmentInfo.operatingAirlineInfo!=null?segmentInfo.operatingAirlineInfo.carrierName:'T\''way air')+''','''+segmentInfo.aircraftInfo.type+'-'+segmentInfo.aircraftInfo.version+''','''+(segmentInfo.operatingAirlineInfo!=null?'Y':'N')+''');'}">
                                        TW101
                                    </button> -->
                                    <!--// 구간 -->
                                    <!-- 출발 -->
                                    <div class="service_name first">
                                        <strong class="tit">12:00</strong>
                                        <span class="addition">NRT</span>
                                    </div>
                                    <!-- 출발 -->
                                    <!-- 설명 -->
                                    <div class="service_exp">

                                        
                                        <p class="top">
                                            
                                                02h
                                            
                                            
                                                55m
                                            
                                        </p>
                                        <p class="bttm">

                                            <!--직항/경유 -->
                                            <button>直航</button>
                                            

                                            <!--<button date-type="layer" date-id="j_detail" class="txt_link">경유<button>-->
                                        </p>
                                    </div>
                                    <!--// 설명 -->
                                    <!-- 도착 -->
                                    <div class="service_name last">
                                        <strong class="tit">14:55</strong>
                                        <span class="addition">ICN</span>
                                        
                                    </div>
                                    <!-- 도착 -->
                                </div>
                                <!--// 비행 정보 박스 -->


                                

                                
                                


                                
                                

                                
                                

                                    <div class="price_info fareInfo" data-dptrTime="1200" data-direct="1" data-fare="639.0">
                                        
                                        <span class="unit">CNY</span>
                                        
                                        <strong class="price">639</strong>
                                        
                                        <p class="empty_seats">3席</p>
                                    </div>

                                

                                


                            </div>
                            <!--// 비행 정보 -->
                        </a>
                        <!-- 상세정보 -->
                        <div class="detail_info fix s3">

                            
                            <!-- 운임박스 -->
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="EventFare" data-depAirportName="东京/成田" data-routeNo="1" disabled="disabled" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="212" id="segmentIndex_1_1" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_1_1">
                                        <span class="icon"></span>活动票价</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;EventFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="D" data-departureTime="12:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="212" data-fareBasis="DYI" data-departureAirportCode="NRT" data-fareTransactionId="336992" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="1" data-journeyTime="02:55" data-arrivalAirportName="首尔/仁川" data-fareType="EventFare" data-departureDateTimeUTC="2019-11-21T03:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121120000" data-arrivalTime="14:55" data-arrivalDateTimeLTC="2019-11-21T14:55:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T12:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T05:55:00" data-arrivalDateTimeString="20191121145500" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 1</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336992" data-baseFare_amount="6000.0" data-discount="0" data-appliedFare="384" data-baseFare_currencyCode="JPY" data-fareClass="D" data-tax="235" data-amount="664" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="0" data-bundSaleYn="N" data-exbgSize="0">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        <p class="service free_bag">免费托运行李 无</p>
                                        

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                


                                <!--해당 운임종류 매진인 경우-->
                                
                                    <div class="rate_price">
                                        <span class="soldout">售罄</span>
                                    </div>
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="SmartFare" data-depAirportName="东京/成田" data-routeNo="1" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="212" id="segmentIndex_1_2" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_1_2">
                                        <span class="icon"></span>智能票价</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;SmartFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="K" data-departureTime="12:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="212" data-fareBasis="KYI" data-departureAirportCode="NRT" data-fareTransactionId="336977" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="1" data-journeyTime="02:55" data-arrivalAirportName="首尔/仁川" data-fareType="SmartFare" data-departureDateTimeUTC="2019-11-21T03:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121120000" data-arrivalTime="14:55" data-arrivalDateTimeLTC="2019-11-21T14:55:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T12:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T05:55:00" data-arrivalDateTimeString="20191121145500" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 1</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336977" data-baseFare_amount="10000.0" data-discount="0" data-appliedFare="639" data-baseFare_currencyCode="JPY" data-fareClass="K" data-tax="235" data-amount="919" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="1" data-bundSaleYn="N" data-exbgSize="15">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        
                                        <p class="service free_bag">
                                            <!--무료위탁수하물 15kg-->
                                            免费托运行李
                                            
                                            15KG
                                            
                                            
                                        </p>

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                
                                    <div class="rate_price">

                                        
                                        

                                        <span class="unit">CNY</span>
                                        <strong class="price">639</strong>
                                        <span class="empty_seats">3席</span>
                                    </div>
                                


                                <!--해당 운임종류 매진인 경우-->
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="NormalFare" data-depAirportName="东京/成田" data-routeNo="1" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="212" id="segmentIndex_1_3" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_1_3">
                                        <span class="icon"></span>一般运费</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;NormalFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="Y" data-departureTime="12:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="212" data-fareBasis="YYI" data-departureAirportCode="NRT" data-fareTransactionId="336985" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="1" data-journeyTime="02:55" data-arrivalAirportName="首尔/仁川" data-fareType="NormalFare" data-departureDateTimeUTC="2019-11-21T03:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121120000" data-arrivalTime="14:55" data-arrivalDateTimeLTC="2019-11-21T14:55:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T12:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T05:55:00" data-arrivalDateTimeString="20191121145500" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 1</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336985" data-baseFare_amount="33000.0" data-discount="0" data-appliedFare="2,109" data-baseFare_currencyCode="JPY" data-fareClass="Y" data-tax="235" data-amount="2,389" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="1" data-bundSaleYn="N" data-exbgSize="15">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        
                                        <p class="service free_bag">
                                            <!--무료위탁수하물 15kg-->
                                            免费托运行李
                                            
                                            15KG
                                            
                                            
                                        </p>

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                
                                    <div class="rate_price">

                                        
                                        

                                        <span class="unit">CNY</span>
                                        <strong class="price">2,109</strong>
                                        <span class="empty_seats">9席</span>
                                    </div>
                                


                                <!--해당 운임종류 매진인 경우-->
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <!-- 운임박스 -->
                            




                        </div>
                        <!--// 상세정보 -->

                    </li>


                    <li class="price_list route_all route_1">
                        <a class="section_list_box" href="#none">
                            <!-- 비행 정보 -->
                            <div class="section_info">

                                <!-- 비행 정보 박스 -->
                                <div class="service_section_box">
                                    <!-- 구간 -->
                                    <button class="bul_air_info" onclick="flightOperateInfo(&#39;德威航空&#39;,&#39;737-800&#39;,&#39;N&#39;,&#39;214&#39;,&#39;TW&#39;);">TW214</button>
                                     	
                                    <!-- 이원구간인 경우, 출발날짜 표기, 2019-07-16 jebaek --> 	
                                    
                                     	
                                    <!--
                                    <button class="bul_air_info" th:text="${segmentInfo.flightIdentifierInfo.carrierCode + segmentInfo.flightIdentifierInfo.flightNumber}"
                                            th:onclick="${'flightOperateInfo('''+(segmentInfo.operatingAirlineInfo!=null?segmentInfo.operatingAirlineInfo.carrierName:'T\''way air')+''','''+segmentInfo.aircraftInfo.type+'-'+segmentInfo.aircraftInfo.version+''','''+(segmentInfo.operatingAirlineInfo!=null?'Y':'N')+''');'}">
                                    -->
                                    <!-- <button th:with="carrierCode=${segmentInfo.flightIdentifierInfo.carrierCode}"
                                        th:class="'bul_air_info' +${carrierCode eq 'TW' ? '' : (carrierCode eq 'IT' ? ' tiger' : ' eastar')}"
                                        th:text="${carrierCode + segmentInfo.flightIdentifierInfo.flightNumber}"
                                        th:onclick="${'flightOperateInfo('''+(segmentInfo.operatingAirlineInfo!=null?segmentInfo.operatingAirlineInfo.carrierName:'T\''way air')+''','''+segmentInfo.aircraftInfo.type+'-'+segmentInfo.aircraftInfo.version+''','''+(segmentInfo.operatingAirlineInfo!=null?'Y':'N')+''');'}">
                                        TW101
                                    </button> -->
                                    <!--// 구간 -->
                                    <!-- 출발 -->
                                    <div class="service_name first">
                                        <strong class="tit">19:00</strong>
                                        <span class="addition">NRT</span>
                                    </div>
                                    <!-- 출발 -->
                                    <!-- 설명 -->
                                    <div class="service_exp">

                                        
                                        <p class="top">
                                            
                                                02h
                                            
                                            
                                                50m
                                            
                                        </p>
                                        <p class="bttm">

                                            <!--직항/경유 -->
                                            <button>直航</button>
                                            

                                            <!--<button date-type="layer" date-id="j_detail" class="txt_link">경유<button>-->
                                        </p>
                                    </div>
                                    <!--// 설명 -->
                                    <!-- 도착 -->
                                    <div class="service_name last">
                                        <strong class="tit">21:50</strong>
                                        <span class="addition">ICN</span>
                                        
                                    </div>
                                    <!-- 도착 -->
                                </div>
                                <!--// 비행 정보 박스 -->


                                

                                
                                


                                
                                

                                
                                

                                    <div class="price_info fareInfo" data-dptrTime="1900" data-direct="1" data-fare="384.0">
                                        
                                        <span class="unit">CNY</span>
                                        
                                        <strong class="price">384</strong>
                                        
                                        <p class="empty_seats">8席</p>
                                    </div>

                                

                                


                            </div>
                            <!--// 비행 정보 -->
                        </a>
                        <!-- 상세정보 -->
                        <div class="detail_info fix s3">

                            
                            <!-- 운임박스 -->
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="EventFare" data-depAirportName="东京/成田" data-routeNo="1" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="214" id="segmentIndex_2_1" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_2_1">
                                        <span class="icon"></span>活动票价</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;EventFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="D" data-departureTime="19:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="214" data-fareBasis="DYI" data-departureAirportCode="NRT" data-fareTransactionId="336992" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="2" data-journeyTime="02:50" data-arrivalAirportName="首尔/仁川" data-fareType="EventFare" data-departureDateTimeUTC="2019-11-21T10:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121190000" data-arrivalTime="21:50" data-arrivalDateTimeLTC="2019-11-21T21:50:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T19:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T12:50:00" data-arrivalDateTimeString="20191121215000" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 2</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336992" data-baseFare_amount="6000.0" data-discount="0" data-appliedFare="384" data-baseFare_currencyCode="JPY" data-fareClass="D" data-tax="235" data-amount="664" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="0" data-bundSaleYn="N" data-exbgSize="0">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        <p class="service free_bag">免费托运行李 无</p>
                                        

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                
                                    <div class="rate_price">

                                        
                                        

                                        <span class="unit">CNY</span>
                                        <strong class="price">384</strong>
                                        <span class="empty_seats">8席</span>
                                    </div>
                                


                                <!--해당 운임종류 매진인 경우-->
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="SmartFare" data-depAirportName="东京/成田" data-routeNo="1" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="214" id="segmentIndex_2_2" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_2_2">
                                        <span class="icon"></span>智能票价</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;SmartFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="H" data-departureTime="19:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="214" data-fareBasis="HYI" data-departureAirportCode="NRT" data-fareTransactionId="336991" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="2" data-journeyTime="02:50" data-arrivalAirportName="首尔/仁川" data-fareType="SmartFare" data-departureDateTimeUTC="2019-11-21T10:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121190000" data-arrivalTime="21:50" data-arrivalDateTimeLTC="2019-11-21T21:50:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T19:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T12:50:00" data-arrivalDateTimeString="20191121215000" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 2</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336991" data-baseFare_amount="8000.0" data-discount="0" data-appliedFare="512" data-baseFare_currencyCode="JPY" data-fareClass="H" data-tax="235" data-amount="792" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="1" data-bundSaleYn="N" data-exbgSize="15">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        
                                        <p class="service free_bag">
                                            <!--무료위탁수하물 15kg-->
                                            免费托运行李
                                            
                                            15KG
                                            
                                            
                                        </p>

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                
                                    <div class="rate_price">

                                        
                                        

                                        <span class="unit">CNY</span>
                                        <strong class="price">512</strong>
                                        <span class="empty_seats">9席</span>
                                    </div>
                                


                                <!--해당 운임종류 매진인 경우-->
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <div class="rate_box fareType">
                                <!-- 운임선택 -->
                                <div class="select_rate">

                                    <input class="tripInfo" type="radio" data-fareType="NormalFare" data-depAirportName="东京/成田" data-routeNo="1" data-arrAirportName="首尔/仁川" data-fareTypeAvail="1" data-arrAirport="ICN" data-depAirport="NRT" data-date="2019-11-21" data-flightNumber="214" id="segmentIndex_2_3" name="tripInfo_1" />

                                    <label class="float_item" tabindex="0" for="segmentIndex_2_3">
                                        <span class="icon"></span>一般运费</label>

                                    

                                    <a class="btn_tooltip alert" href="javascript:fareConditions(&#39;NRT&#39;,&#39;ICN&#39;,&#39;20191121&#39;,&#39;NormalFare&#39;,&#39;JPY&#39;,&#39;JP&#39;);">
                                        <span class="blind">툴팁</span>
                                    </a>


                                    
                                    <!--segment 별 운항 정보-->
                                    <div class="segmentInfo debug" style="display: none;" data-bookingClass="Y" data-departureTime="19:00" data-departureTimeZone="GMT+09:00" data-carrierCode="TW" data-flightNumber="214" data-fareBasis="YYI" data-departureAirportCode="NRT" data-fareTransactionId="336985" data-aircraftInfoVersion="800" data-aircraftInfoType="737" data-segmentIndex="2" data-journeyTime="02:50" data-arrivalAirportName="首尔/仁川" data-fareType="NormalFare" data-departureDateTimeUTC="2019-11-21T10:00:00" data-arrivalTimeZone="GMT+09:00" data-flightDatewithday="2019-11-21(星期四)" data-operatingAirline="德威航空" data-departureDateTimeString="20191121190000" data-arrivalTime="21:50" data-arrivalDateTimeLTC="2019-11-21T21:50:00" data-isPromoCodeApplied="false" data-departureDateTimeLTC="2019-11-21T19:00:00" data-domIntDiv="I" data-stops="0" data-arrivalDateTimeUTC="2019-11-21T12:50:00" data-arrivalDateTimeString="20191121215000" data-departureAirportName="东京/成田" data-flightDate="2019-11-21" data-dayChange="0" data-arrivalAirportCode="ICN" data-fareLevel="EW" data-isUsaRoute="false">segmentInfo : 2</div>

                                    <!--운임종류별 가격 상세정보-->
                                    <div style="display: none;" data-currencyCode="CNY" data-fareTransactionId="336985" data-baseFare_amount="33000.0" data-discount="0" data-appliedFare="2,109" data-baseFare_currencyCode="JPY" data-fareClass="Y" data-tax="235" data-amount="2,389" data-surcharge="45" class="pricingInfo ADULT">&nbsp;</div>
                                    
                                </div>
                                <!-- 운임선택 -->


                                
                                <!-- 서비스 내용 -->
                                
                                    <div class="ancillary" style="display: none;" data-exbgPiece="1" data-bundSaleYn="N" data-exbgSize="15">
                                    </div>
                                    <div class="rate_list">
                                        <p class="service carryon">机内行李 10KG</p>


                                        
                                        
                                        <p class="service free_bag">
                                            <!--무료위탁수하물 15kg-->
                                            免费托运行李
                                            
                                            15KG
                                            
                                            
                                        </p>

                                        
                                        
                                    </div>
                                
                                <!-- 서비스 내용 -->
                                <!-- 서비스 비용 -->

                                
                                
                                    <div class="rate_price">

                                        
                                        

                                        <span class="unit">CNY</span>
                                        <strong class="price">2,109</strong>
                                        <span class="empty_seats">9席</span>
                                    </div>
                                


                                <!--해당 운임종류 매진인 경우-->
                                



                                <!-- 서비스 비용 -->
                            </div>
                            <!-- 운임박스 -->
                            




                        </div>
                        <!--// 상세정보 -->

                    </li>

                </ul>
            </div>
            <!--// 리스트 -->

        
        


    </div>
    <!--// 구간 리스트 -->




    <script type="text/javascript">

        //------- [ 슬라이더UI (탭바 포함) 내 슬라이드 갯수 카운트 ] -------//
        function getSlideCnt(slideWrpper){
            var $el = $(slideWrpper + ' .swiper-slide');
            return $el.length;
        };

        //------- [ 여정선택 UI에서 여정 Swipe 이벤트 발생시 선택한 여정의 구간으로 포커싱 변경 ] -------//
        function changeRouteSlide(sliderId,idx){
            $('.route_all_wrapper.' + sliderId + ' .route_all_inner .routebox').removeClass('current');
            $('.route_all_wrapper.' + sliderId + ' .route_all_inner .routebox:eq(' + idx + ')').addClass('current');
        };

        //------- [ 날짜별 가격선택 슬라이더 UI에서 슬라이드 클릭시 선택한 슬라이드 구간으로 포커싱 변경 ] -------//
        function changePriceSlide(sliderId,idx){
            // $('#' + sliderId + ' .swiper-slide').removeClass('active');
            // $('#' + sliderId + ' .swiper-slide').eq(idx).addClass('active');
            eval(sliderId).slideTo(idx,400,false);
        };

        //------- [ Swiper UI 초기화 ] -------//
        function initSwiper(objId){
            eval(objId).init();

        };

        //------- [ 최저가격선택 슬라이더 설정 ] -------//
        function setPriceSlider(priceSliderId){
            var s = document.createElement('script');
            var innerScript = 'var ' + priceSliderId + ' = new Swiper("#' + priceSliderId + '", {' +
                'init:false,' +
                // 'slidesPerView:"auto",' +
                'slideToClickedSlide:true,' +
                'centeredSlides:true,' +
                'slidesPerView:7,' +
                'freeMode:false,' +
                'navigation:{' +
                    'nextEl: ".sel_date_wrap .btn_slide_next",' +
                    'prevEl: ".sel_date_wrap .btn_slide_prev",' +
                '},' +
                '});' +
                priceSliderId + '.init();';
            s.innerHTML = innerScript;
            $("body").append(s);

            //2019.03.23  운임 조회 선택 슬라이드
            // 활성 클래스 on 추가
            $(".sel_date_wrap .sel_date_slide li").find(".sel_date_box").attr("title", "여정 선택하기");
        	$(".sel_date_wrap .sel_date_slide li.on").find(".sel_date_box").attr("title", "여정 선택됨");
        	$(".sel_date_wrap .sel_date_slide li").on("click", function(e){
        		$(this).addClass("on").find(".sel_date_box").attr("title", "여정 선택됨").parent().siblings("li").removeClass("on").find(".sel_date_box").attr("title", "여정 선택하기");
        		e.preventDefault();
        	});
        };


    </script>

    <script type="text/javascript">
        ///////////// BEGIN - summary 영역 공통 function script /////////////////
        $(function(){

            // Summary 구간
            var swiper = new Swiper('.summary_top_cont .swiper-container', {
                loop: true,
                direction: 'vertical',
                navigation: {
                    nextEl: '.section_slide .btn_slide_next',
                    prevEl: '.section_slide .btn_slide_prev',
                },
            });

            // Summary Open
            var win_h = $(window).height() - sum_top_h,
                sum_h = $('.summary_wrap').height(),
                sum_top_h = $('.summary_top').height() + $('.btn_summary_open').height();
            $('.summary_wrap').css({'bottom':0,'height':win_h});
            $('.btn_summary_open').on('click', function(e) {
                $('html,body').css({'overflow-y':'hidden'});
                $('.summary_top').css({'bottom':'','top':'0'});
                $('.summary_wrap').css({'bottom':'','top':'0','overflow-y':'auto'});
                $('.btn_summary_open').hide();
                $('.btn_summary_close').show();
            });

            // Summary Close
            $('.btn_summary_close').on('click', function(e) {
                $('html,body').css({'overflow-y':''});
                $('.summary_top').css({'bottom':0,'top':'',});
                $('.summary_wrap').css({'bottom':0,'top':'','overflow-y':'hidden'});
                $('.btn_summary_close').hide();
                $('.btn_summary_open').show();
            });

            // 구간 리스트 아코디언
            $.fn.priceListAccordion = function(){
                $('.section_list').find('.detail_info').hide();
                $('.section_list li a.section_list_box').on('click', function(e) {
                    e.preventDefault();
                    function slideDown(target) {
                        slideUp();
                        $(target).addClass('on').next().slideDown(100);
                    }
                    function slideUp() {
                        $('.section_list a.section_list_box').removeClass('on').next().slideUp(100);
                    }
                    $(this).hasClass('on') ? slideUp(100) : slideDown(this);
                    $(this).parent().siblings().removeClass('on');
                    $(this).parent().addClass('on');
                    return false
                });
            };
            $.fn.priceListAccordion();


            $('.bul_air_info, .txt_link').on('click', function() {
                return false
            });

            // Summary 탑승객
            // $('.passenger_list li:first-child a.title').addClass('on');
            // $('.passenger_list').find('.passenger_summary:first').show();
            //2019.03.20 주석처리
            /*$('.passenger_list a.title').on('click', function (e) {
                e.preventDefault();

                function slideDown(target) {
                    slideUp();
                    $(target).addClass('on').next().slideDown(100);
                }

                function slideUp() {
                    $('.passenger_list a.title').removeClass('on').next().slideUp(100);
                }

                $(this).hasClass('on') ? slideUp(100) : slideDown(this);
            });*/

            $.fn.summaryPaxList = function() {

                // $(this).find('.passenger_list li:first-child a.title').addClass('on');
                // $(this).find('.passenger_list').find('.passenger_summary:first').show();
                $(this).find('.passenger_list a.title').on('click', function (e) {
                    e.preventDefault();

                    function slideDown(target) {
                        slideUp();
                        $(target).addClass('on').next().slideDown(100);
                    }

                    function slideUp() {
                        $('.passenger_list a.title').removeClass('on').next().slideUp(100);
                    }

                    $(this).hasClass('on') ? slideUp(100) : slideDown(this);
                });
            };

            $('.btn_tooltip').on('click', function(){
                $(this).addClass('focus');
            });

        });
        ///////////// END - summary 영역 공통 function script /////////////////
    </script>

    <script type="text/javascript">

        /* 2019.03.25 추가 */
        /**
         * 매진인 경우 운임정보 볼 수 없음.
         */
        /*
        $(document).ready(function(){
            $('.section_list li a.soldout').unbind('click');
        });
        */
        /* 2019.03.25 추가 */

        /*
        페이지 진입시, 첫번째 아코디언 펼침.
        */
        $.each($('div.section_list'), function(index,el){
        	$(el).find('ul li.price_list:eq(0) a.section_list_box').addClass('on');
        	$(el).find('ul li.price_list:eq(0) div.detail_info').show();
        });

        /**
         * 이원구간의 경우 class 추가
         */
        $.each($('a.section_list_box'), function(index,el){

            if($(el).find('div.service_section_box').length>1){
                $(el).addClass('multi');
            }

        });

        /**
         * 다음.
         * 선택한 운임 중 번들구매가 가능한 요금이 있으면 해당 화면으로,
         * 그렇지 않으면 STEP2. 탑승자정보 입력 화면으로 이동
         */
        var alert_msg_choose_ininerary = '\u8BF7\u9009\u62E9\u7B2C{0}\u533A\u95F4\u7684\u8FD0\u8D39\u79CD\u7C7B\u3002';//'{0}번째 구간의 운임 종류를 선택하세요.';
        var chooseBundle = function(){

            // 대상 구간 갯수
            var routeCount = 1;

            /**
             * 구간별 운임 선택 여부 확인
             */
            for(var i=1 ; i<=routeCount ; i++){
                if($('.route_'+i).find('.tripInfo:checked').length==0){
                    alert(alert_msg_choose_ininerary.replace('{0}', i ));
                    $('html').scrollTop(0);
                    routeSlider.slideTo((i-1),400,false);
                    return false;
                }
            }

            /**
             * parameters for submit
             */
            var parameters = [];

            // route count
            parameters.push(['routeCount',routeCount]);

            // PaxCountDetails
            var adultCount = parseInt( $('#airAvailabilityRQ').find('input[name="paxCountDetails[0].paxCount"]').val(), 10);
            if(adultCount>0) {
                var PaxCountDetails = 'PaxType=' + 'ADULT';
                PaxCountDetails += '&PaxCount=' + adultCount;
                parameters.push(['PaxCountDetails',PaxCountDetails]);
            }

            var childCount = parseInt( $('#airAvailabilityRQ').find('input[name="paxCountDetails[1].paxCount"]').val(), 10);
            if(childCount>0) {
                var PaxCountDetails = 'PaxType=' + 'CHILD';
                PaxCountDetails += '&PaxCount=' + childCount;
                parameters.push(['PaxCountDetails',PaxCountDetails]);
            }

            var infantCount = parseInt( $('#airAvailabilityRQ').find('input[name="paxCountDetails[2].paxCount"]').val(), 10);
            if(infantCount>0) {
                var PaxCountDetails = 'PaxType=' + 'INFANT';
                PaxCountDetails += '&PaxCount=' + infantCount;
                parameters.push(['PaxCountDetails',PaxCountDetails]);
            }

            /**
             * FlightSegmentInfo
             */

            // each FlightSegmentInfo in ItineraryInfo
            /*
            <FlightSegmentInfo>
                <SegmentId>1</SegmentId>
                <CarrierCode>TW</CarrierCode>
                <FltNumber>291</FltNumber>
                <FlightDate>2018-12-20</FlightDate>
                <DepAirport>ICN</DepAirport>
                <ArrAirport>FUK</ArrAirport>
                <FareClass>H</FareClass>
                <!--<PartnerCarrierCode>ZE</PartnerCarrierCode>
                <PartnerflightNumber>642</PartnerflightNumber>-->
                <Stops>0</Stops>

                <JourneyTime>01:20</JourneyTime>
				<ArrivalDayChange>0</ArrivalDayChange>
				<AircraftType>737</AircraftType>
				<AircraftVersion>800</AircraftVersion>

            </FlightSegmentInfo>
             */

            var mctCheckLayer = [];

            var segmentIdCount = 1;
            for(var i=1 ; i<=routeCount ; i++) {
                var segmentInfo = $('.route_' + i).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo');
                $.each(segmentInfo, function (index, el) {

                    var FlightSegmentInfo = 'SegmentId=' + segmentIdCount++;

                    FlightSegmentInfo += '&CarrierCode=' + $(el).data('carriercode');
                    FlightSegmentInfo += '&FltNumber=' + $(el).data('flightnumber');
                    FlightSegmentInfo += '&FlightDate=' + $(el).data('flightdate');
                    FlightSegmentInfo += '&FlightDateWithDay=' + $(el).data('flightdatewithday');
                    FlightSegmentInfo += '&FareClass=' + $(el).data('bookingclass');
                    FlightSegmentInfo += '&JourneyTime=' + $(el).data('stops');

                    // BundleAvailability 추가 정보
                    FlightSegmentInfo += '&FlightSegmentGroupId=' + i;
                    FlightSegmentInfo += '&JourneyTime=' + $(el).data('journeytime');
                    FlightSegmentInfo += '&ArrivalDayChange=' + $(el).data('daychange');
                    FlightSegmentInfo += '&AircraftType=' + $(el).data('aircraftinfotype');
                    FlightSegmentInfo += '&AircraftVersion=' + $(el).data('aircraftinfoversion');
                    FlightSegmentInfo += '&Stops=' + $(el).data('stops');
                    FlightSegmentInfo += '&DepartureTime=' + $(el).data('departuretime');
                    FlightSegmentInfo += '&ArrivalTime=' + $(el).data('arrivaltime');

                    // for MarkSeat
                    FlightSegmentInfo += '&DepAirport=' + $(el).data('departureairportcode');
                    FlightSegmentInfo += '&DepartureTimeZone=' + $(el).data('departuretimezone');
                    FlightSegmentInfo += '&ScheduledDepartureDateTimeLTC=' + $(el).data('departuredatetimeltc');
                    FlightSegmentInfo += '&ScheduledDepartureDateTimeUTC=' + $(el).data('departuredatetimeutc');
                    FlightSegmentInfo += '&ArrAirport=' + $(el).data('arrivalairportcode');
                    FlightSegmentInfo += '&ArrivalTimeZone=' + $(el).data('arrivaltimezone');
                    FlightSegmentInfo += '&ScheduledArrivalDateTimeLTC=' + $(el).data('arrivaldatetimeltc');
                    FlightSegmentInfo += '&ScheduledArrivalDateTimeUTC=' + $(el).data('arrivaldatetimeutc');

                    // 공동운항정보
                    if(typeof $(el).data('operatingcarriercode') != 'undefined'){
                        FlightSegmentInfo += '&PartnerCarrierCode=' + $(el).data('operatingcarriercode');
                        FlightSegmentInfo += '&PartnerflightNumber=' + $(el).data('operatingflightnumber');
                    }

                    parameters.push(['FlightSegmentInfo',FlightSegmentInfo]);

                    // MCT check를 위해 이전구간 도착시간, 현재구간 출발시간을 배열에 담습니다.
                    if(i>1 && index==0){
                        var mctStatus = $('.route_' + (i-1)).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo').eq(0).data('domintdiv')
                            + $('.route_' + (i-1)).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo').eq(0).data('domintdiv');
                        var mctCheck = { time1:$('.route_' + (i-1)).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo').eq(0).data('arrivaldatetimestring')
                            ,time2:$('.route_' + i).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo').eq(0).data('departuredatetimestring')
                            ,checkType:mctStatus };

                        mctCheckLayer.push(mctCheck);
                    }
                });
            }

            /**
             * MCT CHECK !!
             */
            var mctMap = {'II':'H.3','DD':'H.1','DI':'H.3','ID':'H.3'}; // MCT 관련 환경변수
            var alert_msg_mct_violation = '\u533A\u95F4{0}\u7684\u5230\u8FBE\u65F6\u95F4\u8D77\u6700\u5C11{2}{3}\u540E\u65B9\u53EF\u9009\u62E9\u533A\u95F4{1}\u7684\u822A\u7A0B\u3002';'구간{0}의 도착시간으로 부터 최소 {2}{3}(00분, 0시간) 이후로 구간{1}의 여정을 선택할 수 있습니다.';
            var mct_unit_hour = '\u5C0F\u65F6'; // 시간
            var mct_unit_minutes = '\u5206\u949F'; // 분

            // 구간1의 도착시간으로 부터 최소 3시간 이후로 구간2의 여정을 선택할 수 있습니다.
            console.log(mctCheckLayer);

            var mctCheckFlag = true;

            $.each(mctCheckLayer, function(index, mctarr){
                if(!isValidMCT(mctarr.time1, mctarr.time2, mctMap[mctarr.checkType])){
                    var msg = alert_msg_mct_violation
                        .replace('{0}', index+1) // 이전구간 구간번호
                        .replace('{1}', index+2) // 다음구간 구간번호
                        .replace('{2}', mctMap[mctarr.checkType].split('.')[1]) // interval time
                        .replace('{3}', mctMap[mctarr.checkType].split('.')[0] == 'H' ? mct_unit_hour : mct_unit_minutes) // interval unit
                    ;
                    alert(msg);
                    mctCheckFlag = false;
                    return false;
                }
            });

            if(!mctCheckFlag){
                return false;
            }

            /**
             * FareInfoForGuestType
             */
            /*
             <FareInfoForGuestType>
                <SegmentId>1</SegmentId>
                <FareType>SmartFare</FareType>
                <FareBasisCode>HIF</FareBasisCode>
                <FareClass>H</FareClass>
                <PaxType>ADULT</PaxType>
                <FareTransactionId>267935</FareTransactionId>
                <BaseFare>50000.0</BaseFare>
                <Currency>KRW</Currency>
            </FareInfoForGuestType>
             */
            var paxType = []; // paxType별 FareInfoForGuestType 를 생성하기 위한 배열정보
            if(adultCount>0) paxType.push('ADULT');
            if(childCount>0) paxType.push('CHILD');
            if(infantCount>0) paxType.push('INFANT');



            for(var k=0; k<paxType.length ; k++) {

                var segmentIdCount = 1;
                for(var i=1 ; i<=routeCount ; i++) {

                    var segmentInfo = $('.route_' + i).find('.tripInfo:checked').parents('.fareType').find('.segmentInfo');
                    $.each(segmentInfo, function (index, el) {
                        var FareInfoForGuestType = 'SegmentId=' + segmentIdCount++;
                        FareInfoForGuestType += '&FlightSegmentGroupId=' + i;
                        FareInfoForGuestType += '&FareType=' + $(el).data('faretype');
                        FareInfoForGuestType += '&FareLevel=' + $(el).data('farelevel');
                        FareInfoForGuestType += '&FareBasisCode=' + $(el).data('farebasis');
                        FareInfoForGuestType += '&FareClass=' + $(el).data('bookingclass');
                        FareInfoForGuestType += '&PaxType=' + paxType[k];
                        FareInfoForGuestType += '&FareTransactionId=' + $(el).data('faretransactionid');

                        var pricingInfo = $('.route_' + i).find('.tripInfo:checked').parents('.fareType').find('.pricingInfo.'+paxType[k]);
                        $.each(pricingInfo, function (index, price) {
                            FareInfoForGuestType += '&BaseFare=' + $(price).data('basefare_amount');
                            FareInfoForGuestType += '&Currency=' + $(price).data('basefare_currencycode');
                        });
                        parameters.push(['FareInfoForGuestType',FareInfoForGuestType]);
                    });
                }
            }

            /**
             * bookingType
             */
            //parameters.push(['bookingType',$('#airAvailabilityRQ').find('input[name="bookingType"]:checked').val()]);

            console.log(parameters);

            var frm = $('form[name="airAvailabilityRQ"]');

            $.each(parameters, function(index, param){
                frm.append('<input type="hidden" name="'+ param[0] +'" value="'+ param[1] +'"/>');
            });


            /**
             * parameters for chooseItinerary
             */
            // 탑승객
            frm.append('<input type="hidden" name="pax" value="'+ $('input[name="paxCountDetails[0].paxCount"]').val() +'"/>');
            frm.append('<input type="hidden" name="pax" value="'+ $('input[name="paxCountDetails[1].paxCount"]').val() +'"/>');
            frm.append('<input type="hidden" name="pax" value="'+ $('input[name="paxCountDetails[2].paxCount"]').val() +'"/>');

            // promoCode, 개인만 적용
            if($('input[name="bookingType"]').parent().attr('id') == 'bookingType_individual' && $('input[name="promoCodeDetails.promoCode"]').val()!=''){
                frm.append('<input type="hidden" name="promoCode" value="'+ $('input[name="promoCodeDetails.promoCode"]').val() +'"/>');
            }

            //왕복
            if($('#tripType_RT:checked').length==1) {
                // 출발공항정보
                frm.append('<input type="hidden" name="deptAirportCode" value="'+ $('input[name="availabilitySearches[0].depAirport"]').val() +'"/>');
                frm.append('<input type="hidden" name="deptAirportCode" value="'+ $('input[name="availabilitySearches[1].depAirport"]').val() +'"/>');

                // 도착공항정보
                frm.append('<input type="hidden" name="arriAirportCode" value="'+ $('input[name="availabilitySearches[0].arrAirport"]').val() +'"/>');
                frm.append('<input type="hidden" name="arriAirportCode" value="'+ $('input[name="availabilitySearches[1].arrAirport"]').val() +'"/>');

                // 출발일 정보
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[0].flightDate"]').val() +'"/>');
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[1].flightDate"]').val() +'"/>');
            }
            // 편도
            else if($('#tripType_OW:checked').length==1) {
                // 출발공항정보
                frm.append('<input type="hidden" name="deptAirportCode" value="'+ $('input[name="availabilitySearches[0].depAirport"]').val() +'"/>');
                // 도착공항정보
                frm.append('<input type="hidden" name="arriAirportCode" value="'+ $('input[name="availabilitySearches[0].arrAirport"]').val() +'"/>');
                // 출발일 정보
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[0].flightDate"]').val() +'"/>');
            }
            // 다구간인경우
            else if($('#tripType_MC:checked').length==1){
                for(var i=0 ; i<routeCount ; i++){
                    // 출발공항정보
                    frm.append('<input type="hidden" name="deptAirportCode" value="'+ $('input[name="availabilitySearches['+i+'].depAirport"]').val() +'"/>');
                    // 도착공항정보
                    frm.append('<input type="hidden" name="arriAirportCode" value="'+ $('input[name="availabilitySearches['+i+'].arrAirport"]').val() +'"/>');
                    // 출발일 정보
                    frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches['+i+'].flightDate"]').val() +'"/>');
                }
            }

            var targetUrl = '/app/booking/bundle';
            // var targetUrl = '/app/booking/pax';
            // var bundsaleyn = 'N';

            /**
             * 단체항공권 예매인 경우 번들구매 SKIP
             */
            if(groupBookingYN == 'Y'){
                targetUrl = '/app/booking/pax';

                frm.append('<input type="hidden" name="groupBookingYN" value="Y"/>');
                frm.append('<input type="hidden" name="bundleCode" value=""/>');
                frm.append('<input type="hidden" name="bundleSegmentId" value=""/>');
                frm.append('<input type="hidden" name="bundleSearchFlag" value="false"/>');

            }
            else{
                /**
                 * 부가서비스 구매 가능 운임이 선택되어 있으면 target url 변경
                 */
                /*
                for(var i=1 ; i<=routeCount ; i++){
                    if($('.route_'+i).find('.tripInfo:checked').parents('.fareType').find('.ancillary').data('bundsaleyn') == 'Y'){
                        targetUrl = '/app/booking/pax';
                        return false;
                        // bundsaleyn = 'Y';
                    }
                }
                */
            }

            // loading
            beginLoadingAnimation();

            frm.attr('action',targetUrl).submit();

            /**
             * 선택 가능한 번들이 없어 탑승객정보 입력 화면으로 이동
             */
            /*
            if(bundsaleyn == 'N'){

                var alert_msg_ruquest_login = '\u767B\u5F55\u540E\u65B9\u53EF\u4F7F\u7528\u670D\u52A1\u3002\u8981\u767B\u5F55\u5417\uFF1F';
                if('' ==''){
                    if(confirm(alert_msg_ruquest_login)){

                        /**
                         * 번들정보를 여정 수 만큼 빈 값으로 설정
                         * /
                        frm.find('input[name="bundleCode"]').remove();
                        for(var i=0;i<routeCount;i++){
                            frm.append('<input type="hidden" name="bundleCode" value=""/>');
                        }

                        /**
                         * 여정 및 번들정보 세션에 저장 후 로그인 화면으로 이동
                         * /
                        frm.find('input[name="returnUrl"]').remove();
                        frm.find('input[name="returnSubmitType"]').remove();
                        frm.append('<input type="hidden" name="returnUrl" value="/app/booking/paxGate"/>');
                        frm.append('<input type="hidden" name="returnSubmitType" value="POST"/>');

                        $.ajax({
                            url : "/ajax/booking/setBookingParameters" // ajax url
                            , dataType : 'json' // ajax 통신의 데이터 형식
                            , async: true // 동기(false):비동기(true)
                            , type : 'post'
                            , data : frm.serialize()
                            , success : function(data){
                                console.log(data);
                                frm.attr('action','/app/login/memberLogin').submit();
                            }
                            , error : function(xhr, status, error){
                                var error_confirm=confirm('\u4F20\u9001\u6570\u636E\u8D44\u6599\u53D1\u751F\u9519\u8BEF\u3002\u70B9\u51FB\u786E\u8BA4\u952E\u9875\u9762\u5C06\u5237\u65B0\u3002');
                                if(error_confirm==true){
                                    document.location.reload();
                                };
                            }
                        });

                    }
                }else{

                    // loading
                    $('#wrap').attr('data-loading', '').trigger('datachange');
                    $('.loading-container').fadeIn();

                    frm.attr('action','/app/booking/pax').submit();
                }

            }

            else{

                // loading
                $('#wrap').attr('data-loading', '').trigger('datachange');
                $('.loading-container').fadeIn();

                frm.attr('action',targetUrl).submit();
            }
            */

        };

        /**
         * 조회 요청한 모든 노선의 스케쥴이 존재하는지 확인
         */
        var alert_msg_invalid_schedule = '\u6C92\u6709\u67E5\u8A62\u7684\u884C\u7A0B\u3002';//'조회된 스케줄이 없습니다.';
        /*
        $(document).ready(function(){

            // 대상 구간 갯수
            var routeCount = 1;

            var completeFlag = true;

            for(var i=1 ; i<=routeCount ; i++){
                if($('.route_'+i).length==0){
                    completeFlag = false;
                }
            }

            if(!completeFlag){
                alert(alert_msg_invalid_schedule);
                // $('#getForm').attr('action','/app/booking/searchItinerary').submit();
            }
        });
        */

        /**
         * 적용가능 통화 목록 적용
         */
        var currencyList = [{'baseCurr':'CNY','crsChannel':'CNWEB','crsChannelExplain':'\uD648\uD398\uC774\uC9C0 / CN / CNY','pointOfSale':'CN','regDtime':{'dayOfMonth':18,'dayOfWeek':{'$type':'DayOfWeek','$name':'TUESDAY'},'dayOfYear':261,'hour':7,'minute':13,'month':{'$type':'Month','$name':'SEPTEMBER'},'monthValue':9,'nano':0,'second':11,'year':2018},'regIp':'192.168.56.85','regMemId':'sykim8','regMemName':'\uAE40\uC138\uC724','regMemSeq':48,'searchSiteDiv':[],'siteDiv':'HP','updDtime':null,'updIp':null,'updMemId':null,'updMemName':null,'updMemSeq':null,'useYn':'Y'},{'baseCurr':'JPY','crsChannel':'JPWEB','crsChannelExplain':'\uD648\uD398\uC774\uC9C0 / JP /JPY  ','pointOfSale':'JP','regDtime':{'dayOfMonth':18,'dayOfWeek':{'$type':'DayOfWeek','$name':'TUESDAY'},'dayOfYear':261,'hour':7,'minute':11,'month':{'$type':'Month','$name':'SEPTEMBER'},'monthValue':9,'nano':0,'second':47,'year':2018},'regIp':'192.168.56.85','regMemId':'sykim8','regMemName':'\uAE40\uC138\uC724','regMemSeq':48,'searchSiteDiv':[],'siteDiv':'HP','updDtime':null,'updIp':null,'updMemId':null,'updMemName':null,'updMemSeq':null,'useYn':'Y'},{'baseCurr':'KRW','crsChannel':'Guest EN','crsChannelExplain':'\uD648\uD398\uC774\uC9C0 / KR / KRW','pointOfSale':'KR','regDtime':{'dayOfMonth':18,'dayOfWeek':{'$type':'DayOfWeek','$name':'WEDNESDAY'},'dayOfYear':199,'hour':15,'minute':36,'month':{'$type':'Month','$name':'JULY'},'monthValue':7,'nano':0,'second':40,'year':2018},'regIp':'192.168.56.201','regMemId':'smkang','regMemName':'\uAC15\uC131\uBAA8','regMemSeq':1,'searchSiteDiv':[],'siteDiv':'HP','updDtime':{'dayOfMonth':18,'dayOfWeek':{'$type':'DayOfWeek','$name':'TUESDAY'},'dayOfYear':261,'hour':7,'minute':4,'month':{'$type':'Month','$name':'SEPTEMBER'},'monthValue':9,'nano':0,'second':48,'year':2018},'updIp':'192.168.56.85','updMemId':'sykim8','updMemName':'\uAE40\uC138\uC724','updMemSeq':48,'useYn':'Y'}];
        var pos = null;
        var currency = null;

        $('#currencyList').empty();
        $.each(currencyList, function(index, el){

            var flag = true;

            $.each($('#currencyList option'), function(ci,cc){
                if($(cc).val() == el.baseCurr){
                    flag = false;
                }
            });

            if(flag){
                $('#currencyList').append('<option value="'+el.baseCurr+'" data-pos="'+el.pointOfSale+'"'+ (pos==el.pointOfSale?' selected':'')  +'>'+el.baseCurr+'</option>');
            }
        });


        /**
         * summary 영역 통화 출력
         */
        $('.summary_currency').text(currency!=null?currency:$('#currencyList').val());

        /**
         * 구간별 편명 선택시 summary 영역 구성 및 여정정보 표출
         */
        $(document).ready(function(){

            // 항목별 티이틀
            var msg_company = '\u966A\u4F34';//'동반';
            var msg_section = '\u533A\u6BB5';//'구간';
            var msg_direct_y = '\u76F4\u822A';//'직항';
            var msg_direct_n = '\u7ECF\u7531';//'경유';

            var max_paxType = {'ADULT':'\u6210\u4EBA','CHILD':'\u513F\u7AE5','INFANT':'\u5A74\u513F'};
            var msg_faretype = {'NormalFare':'Normal Fare'
                ,'SmartFare':'Smart Fare'
                ,'EventFare':'Event Fare'};

            var msg_appliedFareTitle = '\u673A\u7968\u8FD0\u8D39';//'항공운임';
            var msg_surchargeTitle = '\u71C3\u6CB9\u9644\u52A0\u8D39';//'유류할증료';
            var msg_taxTitle = '\u673A\u573A\u4F7F\u7528\u8D39';//'공항시설사용료';
            var msg_exbgTitle = '\u514D\u8D39\u6258\u8FD0\u884C\u674E';//'무료위탁수하물';
            var msg_handLuggageTitle = '\u968F\u8EAB\u643A\u5E26\u884C\u674E';//'기내수하물';
            var msg_bundle = 'Bundle';//'부가서비스 번들';
            var msg_discount = '\u6253\u6298\u4F18\u60E0\u660E\u7EC6';//'할인 내역';
            var msg_passengerInfo = '\u4E58\u673A\u4EBA\u8BE6\u7EC6\u4FE1\u606F';//'탑승객별 상세정보';
            var msg_standardTitle = '';//'1인 편도 총액 기준';

            var msg_totalTitle = 'TOTAL';
            var msg_subtotalTitle = 'SUBTOTAL';


//             var msg_soldout         = '\u552E\u7F44';//'매진';
//             var msg_flightOff         = '\u975E\u8FD0\u884C';//'비운항';

            var msg_flightdateTitle         = '\u51FA\u53D1\u65E5\u671F';//'출발일';
            var msg_flightnumberTitle       = '\u822A\u73ED\u540D';//'편명';
            var msg_scheduleTitle           = '\u51FA\u53D1\u5230\u8FBE\u65F6\u95F4';//'출도착시각';
            var msg_journeytimeTitle        = '\u98DE\u884C\u65F6\u95F4';//'비행시간';
            var msg_directTitle             = '\u8FD0\u884C\u533A\u5206';//'운항구분';
            var msg_operatingairlineTitle   = '\u5B9E\u9645\u822A\u8FD0\u516C\u53F8';//'실제운항사';
            var msg_faretypeTitle           = '\u8FD0\u8D39\u79CD\u7C7B';//'운임종류';

            var currencyTitle = 'CNY';

            // 탑승요청인원
            var paxCountDetails = [{'paxCount':1,'paxType':'ADULT'}];

            $('input.tripInfo').on('change', function(){

                /**
                 * div.rate_box on class 추가, 2019-03-30
                 */
                $('div.rate_box.on').removeClass('on');
                $.each($('input.tripInfo:checked'), function(rindex, ri){
                    $(ri).parents('div.rate_box').addClass('on');
                });

                // 총 합계운임
                var totalAmount = 0.0;

                var tmplArray = [];

                // 선택한 요금정보를 저장할 변수 초기화
                selectedFareType = [];


                // 구간별 loop
                $('input.tripInfo:checked').each(function(index,trip){

                    var routeAmount = 0;

                    selectedFareType.push($(trip));

                    /**
                     * 상단 slide 영역 정보 표출
                     */
                    var routeNo = $(trip).data('routeno');
                    console.log('routeNo:'+routeNo);

                    // 구간별 선택 노선 정보
                    var route_slide_fltNumber = '';
                    var route_slide_departureDate = '';

                    $(trip).parent().find('.segmentInfo').each(function(index, seg){
                        if(route_slide_fltNumber!=''){
                            route_slide_fltNumber += ' | ';
                            route_slide_departureDate += ' | ';
                        }
                        route_slide_fltNumber += $(seg).data('carriercode')+$(seg).data('flightnumber');
                        route_slide_departureDate += $(seg).data('flightdatewithday');
                    });

                    // 슬라이드 영역
                    var route_slide = $('#route_'+routeNo+' div.service_exp');

                    // route_slide.find('.ico_plain').hide();
                    route_slide.find('.fltNumber').html(route_slide_fltNumber).show();
                    route_slide.find('.departureDate').html(route_slide_departureDate).show();

                    // 박스 영역 (전체보기)
                    var route_box = $('#box_route_'+routeNo+' div.service_exp');
                    // route_box.find('.ico_plain').hide();
                    route_box.find('.fltNumber').html(route_slide_fltNumber).show();
                    route_box.find('.departureDate').html(route_slide_departureDate).show();

                    /**
                     * summary template 구성 / 표출
                     */

                    var route = [];

                    // 구간정보
                    route.depAirport = $(trip).data('depairport');
                    route.depAirportName = $(trip).data('depairportname');
                    route.arrAirport = $(trip).data('arrairport');
                    route.arrAirportName = $(trip).data('arrairportname');
                    route.currency = currencyTitle;
                    route.section = msg_section;

                    route.totalTitle = msg_totalTitle;
                    route.subtotalTitle = msg_subtotalTitle;

                    // segment별 loop
                    var segmentArray = [];
                    $(trip).parent().find('.segmentInfo').each(function(index, seg){
                        var segment = [];

                        // label
                        segment.flightdateTitle = msg_flightdateTitle;      // 날짜
                        segment.flightnumberTitle = msg_flightnumberTitle;      // 편명
                        segment.scheduleTitle = msg_scheduleTitle;      // 출도착시각
                        segment.journeytimeTitle = msg_journeytimeTitle;      // 비행시간
                        segment.directTitle = msg_directTitle;      // 운항구분
                        segment.operatingairlineTitle = msg_operatingairlineTitle;      // 실제운항사
                        segment.faretypeTitle = msg_faretypeTitle;     // 운임종류
                        segment.exbgTitle = msg_exbgTitle; // 무료 위탁수하물
                        segment.handLuggageTitle = msg_handLuggageTitle; // 기내수하물


                        var journeyTime = $(seg).data('journeytime').split(':');
                        segment.depAirport = $(seg).data('departureairportcode');
                        segment.depAirportName = $(seg).data('departureairportname');
                        segment.arrAirport = $(seg).data('arrivalairportcode');
                        segment.arrAirportName = $(seg).data('arrivalairportname');
                        segment.flightDate = $(seg).data('flightdate');      // 날짜
                        segment.carrierCode = $(seg).data('carriercode');     // 편명
                        segment.flightNumber = $(seg).data('flightnumber');     // 편명
                        segment.schedule = $(seg).data('departuretime');
                        segment.schedule += ' ~ ';
                        segment.schedule += $(seg).data('arrivaltime');        // 출도착시각
                        segment.schedule += parseInt($(seg).data('daychange'),10)==0?'':' +' + $(seg).data('daychange');        // 출도착시각 +1 dayChange
                        segment.journeyTime = journeyTime[0]+'h '+journeyTime[1]+'m';     // 비행시간
                        segment.segment = parseInt($(seg).data('stops'),10)==0?msg_direct_y:msg_direct_n;         // 직항/경유 구분
                        segment.operatingAirline = $(seg).data('operatingairline');// 실제운항사
                        segment.fareType = msg_faretype[$(seg).data('faretype')];        // 운임종류

                        // 무료위탁수하물 정보 추가
                        var anc = $(seg).parents('div.rate_box.fareType').find('div.ancillary');
                        segment.exbgsize = anc.data('exbgsize');        // 무료위탁수하물 무게
                        segment.exbgpiece = anc.data('exbgpiece');        // 무료위탁수하물 수량
                        segment.isusaroute = $(seg).data('isusaroute');

                        segment.stops = $(seg).data('stops');
                        segment.fareTypes = $(seg).data('faretype');
                        segment.fareBasisCode = $(seg).data('farebasis');

                        segmentArray.push(segment);
                    });
                    route.segment = segmentArray;

                    // 탑승객별 운임정보 loop
                    var paxArray = [];
                    $.each(paxCountDetails, function(index, el){

                        for(var i=1;i<=el.paxCount ; i++){
                            var pax = [];
                            var pricingInfo = $(trip).parent().find('.pricingInfo.'+el.paxType);

                            if(el.paxType == 'INFANT'){
                                pax.paxName = max_paxType[el.paxType] + ' ' + i + ' ('+max_paxType['ADULT'] +' '+i+' '+msg_company+')'; // 유아 1 (성인 1 동반)
                            }
                            else{
                                pax.paxName = max_paxType[el.paxType] + ' ' + i; // 성인 1
                            }

                            pax.paxType = el.paxType; // paxtype

                            //항공운임
                            pax.appliedFareTitle = msg_appliedFareTitle;
                            pax.appliedFare = $(pricingInfo).data('appliedfare');
                            //유류할증료
                            pax.surchargeTitle = msg_surchargeTitle;
                            pax.surcharge = $(pricingInfo).data('surcharge');
                            //공항시설사용료
                            pax.taxTitle = msg_taxTitle;
                            pax.tax = $(pricingInfo).data('tax');
                            // 승객별 운임 합계
                            pax.subtotal = $(pricingInfo).data('amount');

                            pax.bundleTitle = msg_bundle;
                            pax.discountTitle = msg_discount;
                            pax.passengerInfoTitle = msg_passengerInfo;
                            pax.standardTitle = msg_standardTitle;

                            pax.currency = currencyTitle;

                            // 공항시설사용료 레이어팝업 데이터
                            segment = segmentArray[0];
                            pax.stops = segment.stops;
                            pax.fareTypes = segment.fareTypes;
                            pax.fareBasisCode = segment.fareBasisCode;
                            pax.flightDate = segment.flightDate;      // 날짜
                            pax.carrierCode = segment.carrierCode;     // 편명
                            pax.flightNumber = segment.flightNumber;     // 편명

                            pax.fareClass = $(pricingInfo).data('fareclass');
                            pax.baseFare = $(pricingInfo).data('basefare_amount');
                            pax.fareTransactionId = $(pricingInfo).data('faretransactionid');

                            paxArray.push(pax);

                            // 합계운임
                            totalAmount += parseFloat(($(pricingInfo).data('amount')+'').replace(/,/gi, ""));

                            // 구간별 운임 합계
                            routeAmount += parseFloat(($(pricingInfo).data('amount')+'').replace(/,/gi, ""));

                            // console.log(totalAmount);
                        }
                    });
                    route.pax = paxArray;
                    route.routeAmount = currencyNumberFormat(currencyTitle, routeAmount);

                    tmplArray.push(route);


                    // 총 합계운임 적용
                    $('#summary_title_amount').text(currencyNumberFormat(currencyTitle, totalAmount));

                });

                $('#summary').empty();
                $('#summary_tmpl').tmpl({route:tmplArray}).appendTo('#summary');

                // upsell check
                upgradeFareType($(this));

                // subtotal 더보기 class event bind
                // $.fn.viewer();


                for(var i=1;i<=4;i++){
                    if($('#summary_tab'+i).length>0){
                        $('#tab'+i).html($('#summary_tab'+i).html());
                        $('#tab'+i).summaryPaxList();
                    }
                }


                // 동반 유아를 성인 아래 열에 끼워넣기 위한 작업
                $.each($('div.tab_cont'), function(index,el){

                    $.each($(el).find($('div.passenger_list li.INFANT')),function(index,o){
                        $(o).insertAfter($(el).find($('div.passenger_list li.ADULT').eq(index)));
                        // $(o).text($(o).text()+' '+(index+1)+ ' ('+label_adult+' '+(index+1)+' '+label_company+')');
                    });
                });


                $.fn.summaryPaxList();

                // console.log(tmplArray.length);

                // console.log('########## 선택하신 요금 정보입니다. ############');
                // $.each(selectedFareType, function(index,ft){
                //     console.log(ft)
                // });

                // 운임 선택한 경우, 다음 구간으로 자동 슬라이드, 2019-07-12 jebaek
                var routeCount = 1;
                var routeNo = $(this).data('routeno');                
                if(routeNo != routeCount) {
                	routeSlider.slideTo((routeNo),400,false);
                	$('html').scrollTop(0);
                }
            });

        });

        /**
         * EventFare 선택시 upsell 레이어 호출, 국내선은 호출하지 않습니다.
         */
        var upgradeFareType = function(el){

            if(!beingResetDisplayFlag){
                var eventfare = 'EventFare';
                var segmentId = $(el).attr('id');

                if($(el).parent().find('div.segmentInfo').data('domintdiv')!='D' && !$(el).parent().find('div.segmentInfo').data('isusaroute') && $(el).data('faretype')==eventfare ){

                    var fareTypeElements = [];
                    fareTypeElements.push($(el).parents('.fareType').parent().find('.fareType').eq(0)); // event

                    if($(el).parents('.fareType').parent().find('.fareType').eq(1).find('.tripInfo').data('faretypeavail')=='1'){
                        fareTypeElements.push($(el).parents('.fareType').parent().find('.fareType').eq(1)); // 스마트운임 영역
                    }else if($(el).parents('.fareType').parent().find('.fareType').eq(2).find('.tripInfo').data('faretypeavail')=='1'){
                        fareTypeElements.push($(el).parents('.fareType').parent().find('.fareType').eq(2)); // 일반운임 영역
                    }

                    if(fareTypeElements.length==2){
                        var upgradeFareType = fareTypeElements[1].find('.segmentInfo').data('faretype'); // 업그레이드 대상 운임
                        var currencyCode = fareTypeElements[1].find('.pricingInfo.ADULT').data('currencycode'); // 기준 통화
                        var overCharge = parseFloat((''+fareTypeElements[1].find('.pricingInfo.ADULT').data('appliedfare')).replace(/,/g,'')); // 차액
                        overCharge -= parseFloat((''+fareTypeElements[0].find('.pricingInfo.ADULT').data('appliedfare')).replace(/,/g,''));
                        overCharge = currencyNumberFormat(currencyCode, overCharge);
                        var exbgSize = fareTypeElements[1].find('.ancillary').data('exbgsize'); // 위탁수하물 중량
                        var exbgPiece = fareTypeElements[1].find('.ancillary').data('exbgpiece'); // 위탁수하물 수량
                        var bundSaleYn = fareTypeElements[1].find('.ancillary').data('bundsaleyn'); // 부가서비스 번들 구매 가능 여부

                        // console.log(segmentId,eventfare,upgradeFareType,overCharge,currencyCode,exbgSize,exbgPiece,bundSaleYn);

                        fareUpgrade(segmentId,eventfare,upgradeFareType,overCharge,currencyCode,exbgSize,exbgPiece,bundSaleYn);
                    }
                }
            }

        };

        /**
         * 주간 최저운임 조회
         */
        var ieFirstFlag = true;
        var lowestFare = function(criteriaDate, period, deptAirportCode, arriAirportCode, routeCount){

            var currency = 'CNY';
            var tripType = 'OW';
            var baseDeptAirportCode = deptAirportCode;
            var msg_soldout         = '\u552E\u7F44';//'매진';
            var msg_flightOff         = '\u975E\u8FD0\u884C';//'비운항';
            var totalFareDispYnTitle = 'N'; // 총액운임 여부
            
            if(tripType=='RT' && routeCount==2){
                baseDeptAirportCode = arriAirportCode;
            }

            $.ajax({
                url : "/ajax/booking/lowestFare" // ajax url
                , dataType : 'json' // ajax 통신의 데이터 형식
                , async:true // 동기(false):비동기(true)
                , type : 'get'
                , data : { groupBookingYN : groupBookingYN
                    ,criteriaDate : criteriaDate
                    , period:period
                    , deptAirportCode:deptAirportCode
                    , arriAirportCode:arriAirportCode
                    , baseDeptAirportCode:baseDeptAirportCode
                    , currency:currency}
                , success : function(data) {
                    var tmplArray = {};

                    tmplArray.lowestFareMstList = data.data.lowestFareMstList; // 가격정보 목록
                    tmplArray.lowestFareDtlMap = data.data.lowestFareDtlMap;   // 가격정보 상세 map
                    tmplArray.criteriaDate = criteriaDate; // 기준일
                    tmplArray.period = period; // 조회기준
                    tmplArray.routeCount = routeCount; // 구간번호
                    tmplArray.currency = currency; // 기준통화
                    tmplArray.soldout = msg_soldout; // 매진
                    tmplArray.flightOff = msg_flightOff; // 비운항
                    tmplArray.totalFareDispYn = totalFareDispYnTitle // 총액운임 여부
                    
                    if(tmplArray.lowestFareMstList.length > 0){

                        /**
                         * 가격정보 슬라이더 최초 초기화
                         */
                        if (period == 'PN') {
                            $('#lowestfare_tmpl').tmpl(tmplArray).insertAfter('#beginLowestPriceList_' + routeCount);
                            setPriceSlider('price_slider_' + routeCount);

                            /**
                             * 기준일자로 슬라이드 선택
                             */
                            $.each($('.route_' + routeCount + ' .lowestFare'), function (index, fare) {
                                if ($(fare).data('flightdate') == criteriaDate) {
                                    changePriceSlide('price_slider_' + routeCount, index);
                                }
                            });

                            /**
                             * 슬라이드 이동에 따른 이전/다음요금 조회를 위한 event handler
                             */
                            //슬라이드 체인지 이벤트
                            var slider = eval('price_slider_' + routeCount);
                            slider.on('slideChange', function () {

                                var slideCount = getSlideCnt('#price_slider_' + routeCount);
                                console.log('현재 슬라이드 : ' + (slider.realIndex + 1) + ' of ' + slideCount);


                                if (slider.realIndex == 0) {
                                    console.log('이전기간 요금조회 요청');
                                    $('#price_slider_' + routeCount + ' .lowestFarePrev').trigger('click');
                                } else if (slider.realIndex == slideCount - 1) {
                                    console.log('다음기간 요금조회 요청');
                                    $('#price_slider_' + routeCount + ' .lowestFareNext').trigger('click');
                                }

                                if (slider.realIndex == slideCount) {
                                    console.log('마지막 슬라이드');
                                }
                            });

                            /**
                             * 오늘날짜 활성화 클래스 적용
                             */
                            var slider = eval('price_slider_' + routeCount);
                            $('#price_slider_'+routeCount).find('li').eq(slider.realIndex+1).addClass('on');
                        }
                        /**
                         * 이전 요금 조회
                         */
                        else if (period == 'P') {
                            appendLayer('lowestFareTemplate');
                            $('#lowestfare_tmpl').tmpl(tmplArray).appendTo('#lowestFareTemplate');
                            eval('price_slider_' + routeCount).prependSlide($('#lowestFareTemplate').html().split('<!--//split-->').reverse());
                            $('#lowestFareTemplate').remove();
                        }
                        /**
                         * 다음 요금 조회
                         */
                        else if (period == 'N') {
                            eval('price_slider_' + routeCount).appendSlide($('#lowestfare_tmpl').tmpl(tmplArray));
                        }



                    }

                    if('PN' == period && routeCount>1){
                        $('.route_'+routeCount).hide();
                    }

                }
                , error : function(xhr, status, error){
                    var error_confirm=confirm('\u4F20\u9001\u6570\u636E\u8D44\u6599\u53D1\u751F\u9519\u8BEF\u3002\u70B9\u51FB\u786E\u8BA4\u952E\u9875\u9762\u5C06\u5237\u65B0\u3002');
                    if(error_confirm==true){
                        document.location.reload();
                    };
                }
            });
        };

        /**
         * 구간별 최저운임 기간 표시를 위한 AvailabilitySearches
         */
        var availabilitySearches = [{'arrAirport':'ICN','depAirport':'NRT','flightDate':'2019-11-21'}];
        console.log(availabilitySearches);

        /**
         * 최초 진입시 구간별 최저 운임 표시 및 기존 선택되어있던 faretype 재 설정
         */
        $(document).ready(function(){

            //유효하지 않은 할인코드 입력 시 메세지 표출 후 예매1단계로 이동
            var errType = null;
            if(errType != null && errType.errorCode == "AIRLINE_615") {
                alert('Invalid Promo Code');
                document.location="/app/booking/searchItinerary";
            }


            $.each(availabilitySearches, function(index, el){
                el.flightDate = el.flightDate.replace(/\-/g,""); // yyyy-MM-dd -> yyyyMMdd
                lowestFare(el.flightDate, 'PN', el.depAirport, el.arrAirport, index+1);
            });


            console.log('************* selectedFareType size : ' + selectedFareType.length);

            /**
             * faretype 재설정
             */
            resetDisplayInfo();
            beingResetDisplayFlag = true;
            $.each(selectedFareType, function(index,ft){

                console.log('[selectedFareType] '+ ft.data('depairport')  +'/'+ ft.data('arrairport') +'/'+ ft.data('date'));

                $.each($('input.tripInfo'), function(idx, tr){

                    console.log($(tr).data('depairport')  +'/'+ $(tr).data('arrairport') +'/'+ $(tr).data('date'));

                    if(ft.data('depairport')  == $(tr).data('depairport')
                        && ft.data('arrairport')  == $(tr).data('arrairport')
                        && ft.data('flightnumber')  == $(tr).data('flightnumber')
                        && ft.data('faretype')  == $(tr).data('faretype')
                        && ft.data('date')  == $(tr).data('date')){
                        $(tr).prop('checked',true);
                        $(tr).trigger('change');
                    }
                });
            });
            beingResetDisplayFlag = false;
        });


        /**
         * 최초 노출시 첫번째 구간 편명 목록 노출
         */
        // $(document).ready(function(){
        //     console.log($('div.route_1').length);
        //     $('div.route_1').show();
        // });

        /**
         * 구간별 이전/다음 운임정보 조회 요청
         */
        $(document).ready(function(){
            $('.lowestFarePrev,.lowestFareNext').on('click',function(){
                var period = $(this).data('period');
                var route_num = $(this).data('route_num');

                // criteriaDate, period, deptAirportCode, arriAirportCode, routeCount
                var criteriaDate = '';
                var deptAirportCode = availabilitySearches[(parseInt(route_num,10)-1)].depAirport;
                var arriAirportCode = availabilitySearches[(parseInt(route_num,10)-1)].arrAirport;
                var routeCount = route_num;

                // 이전 조회
                if('P'==period){
                    criteriaDate = $('#price_slider_'+route_num+' .lowestFare').eq(0).data('flightdate');
                }
                // 다음 조회
                else if('N'==period){
                    criteriaDate = $('#price_slider_'+route_num+' .lowestFare').eq($('#price_slider_'+route_num+' .lowestFare').length-1).data('flightdate');
                }

                console.log('기준일자 : ' + criteriaDate);
                lowestFare(criteriaDate, period, deptAirportCode, arriAirportCode, routeCount);
            });
        });

        /**
         * 주간 최저운임으로부터 다른 출발일 선택 처리
         */
        var changeFlightDate = function(routeCount, flightDate, changeOrder){

            var multiTripItineraryCount = 1;
            var routeIndex = parseInt(routeCount,10)-1;
            flightDate = flightDate.substr(0,4) +'-' + flightDate.substr(4,2) + '-' + flightDate.substr(6,2);
            $('input[name="availabilitySearches['+routeIndex+'].flightDate"]').val(flightDate);

            var frm = $('#airAvailabilityRQ');

            frm.find('input[name="schedule"]').remove();
            frm.find('input[name="changeOrder"]').remove();

            frm.append('<input type="hidden" name="changeOrder" value="'+changeOrder+'"/>');

            //왕복
            if($('#tripType_RT:checked').length==1) {
                // 출발일 정보
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[0].flightDate"]').val() +'"/>');
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[1].flightDate"]').val() +'"/>');
            }
            // 편도
            else if($('#tripType_OW:checked').length==1) {
                // 출발일 정보
                frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches[0].flightDate"]').val() +'"/>');
            }
            // 다구간인경우
            else if($('#tripType_MC:checked').length==1){
                for(var i=0 ; i<multiTripItineraryCount ; i++){
                    // 출발일 정보
                    frm.append('<input type="hidden" name="schedule" value="'+ $('input[name="availabilitySearches['+i+'].flightDate"]').val() +'"/>');
                }
            }

            $.ajax({
                url : "/ajax/booking/changeFlightDate" // ajax url
                , dataType : 'json' // ajax 통신의 데이터 형식
                , async:true // 동기(false):비동기(true)
                , type : 'post'
                , data : $("#airAvailabilityRQ").serialize()
                , success : function(data){
                    // 첫번째 구간으로 슬라이드 이동
                    // routeSlider2.slideTo(0,400,false);
                    // 요금조회
                    if(!data.success) {
	            		endLoadingAnimation();
	            		alert('\u4F20\u9001\u6570\u636E\u8D44\u6599\u53D1\u751F\u9519\u8BEF\u3002\u70B9\u51FB\u786E\u8BA4\u952E\u9875\u9762\u5C06\u5237\u65B0\u3002');
	            		return false;
	            	} else {
	            		loadAirAvail(currenctRouteSliderIndex);
	            	}
                }
                , error : function(xhr, status, error){
                    var error_confirm=confirm('\u4F20\u9001\u6570\u636E\u8D44\u6599\u53D1\u751F\u9519\u8BEF\u3002\u70B9\u51FB\u786E\u8BA4\u952E\u9875\u9762\u5C06\u5237\u65B0\u3002');
                    if(error_confirm==true){
                        document.location.reload();
                    };
                }
            });
        };

        /**
         * 대기알림 등록 레이어 호출
         */
        var alert_msg_ruquest_login = '\u767B\u5F55\u540E\u65B9\u53EF\u4F7F\u7528\u670D\u52A1\u3002\u8981\u767B\u5F55\u5417\uFF1F';
        var label_msg = '\u7533\u8BF7\u5B8C\u6BD5'; //'신청 완료';
        var return_url = '/app/booking/chooseItinerary';
        $(document).ready(function(){
            $.each($('.standbyRequest'),function(index,el){

                var dptrDate = $(el).data('dptrdate');
                var fltNo = $(el).data('fltno');
                var deptAirportCode = $(el).data('deptairportcode');
                var arriAirportCode = $(el).data('arriairportcode');
                var dptrTime = $(el).data('dptrtime');
                var arriTime = $(el).data('arritime');

                var onclickStr = 'standbyPush(\''+dptrDate+'\',\''+fltNo+'\',\''+deptAirportCode+'\',\''+arriAirportCode+'\',\''+dptrTime+'\',\''+arriTime+'\',\''+alert_msg_ruquest_login+'\',\''+return_url+'\')';
                $(el).attr('onclick',onclickStr);
            });
        });

        var taxInfo = function(flightSegmentGroupId, segmentId, carrierCode, stops, fltNumber, flightDate, depAirport, arrAirport, fareClass, fareType, fareBasisCode, baseFare, currency, fareTransactionId, fareComponentId) {
        	// loading
            beginLoadingAnimation();
        	taxInfoLayer(flightSegmentGroupId, segmentId, carrierCode, stops, fltNumber, flightDate, depAirport, arrAirport, fareClass, fareType, fareBasisCode, baseFare, currency, fareTransactionId, fareComponentId);
        };

        $(function(){
            $('.bul_air_info, .sbtn_cont.alram').on('click', function() {
                $(this).addClass('focus');
            });
        });

    </script>

    <!--주단위 최저가 조회 template-->
    <script id="lowestfare_tmpl" type="text/x-jquery-tmpl">
        {%each(index, el) lowestFareMstList%}


            <li class="swiper-slide lowestFare" data-flightDate="${el.flightDate}"
            {%if el.flightDate != criteriaDate || period!='PN'%}
                onclick="changeFlightDate('${routeCount}', '${el.flightDate}' {%if period=='PN' && criteriaDate < el.flightDate%},'forward'{%/if%} {%if period=='PN' && criteriaDate > el.flightDate%},'reward'{%/if%} {%if period=='P'%},'reward'{%/if%} {%if period=='N'%},'forward'{%/if%} );"
            {%/if%}
            >
                <a href="#none" class="sel_date_box">
                    <span class="date">${el.date}(${el.dayOfTheWeek})</span>

                    <!--비운항-->
                    {%if el.flightOperateYn == 'N'%}
                        <span class="price">${flightOff}</span>
                    {%/if%}

                    <!--매진, 비운항인 경우 매진이더라도 표기 하지 않습니다. -->
                    {%if el.flightOperateYn != 'N' && el.soldoutYn == 'Y'%}
                        <span class="price">${soldout}</span>
                    {%/if%}

                    <!--가격 정보가 있고, 단체항공권이 아닌 경우 최저운임정보 노출-->
                    {%if typeof lowestFareDtlMap[el.flightDate] != 'undefined' && el.soldoutYn != 'Y' && el.flightOperateYn != 'N' %}
						{%if totalFareDispYn == 'Y'%}
                        	<span class="price">${currencyNumberFormat($('#currencyList').val(),lowestFareDtlMap[el.flightDate].totalAmt)}</span>
						{%/if%}
						{%if totalFareDispYn == 'N'%}
                        	<span class="price">${currencyNumberFormat($('#currencyList').val(),lowestFareDtlMap[el.flightDate].fareAmt)}</span>
						{%/if%}
                    {%/if%}

                </a>
            </li>
            {%if index > 0%}
            <!--//split-->
            {%/if%}

        {%/each%}
    </script>


    <!--하단 summary 영역 구간별 template-->
    <script id="summary_tmpl" type="text/x-jquery-tmpl">


    <div class="tab_wrap">

        <ul class="tab n4">
            {%each(index, el) route%}
                <li><a href="#tab${index+1}"><!--구간 1 (ICN - KIX)-->${section}${index+1} (${depAirport}-${arrAirport})</a></li>
            {%/each%}
        </ul>


        {%each(index, el) route%}


            <div class="tab_cont" id="summary_tab${index+1}">

                    {%each el.segment%}

                        <div class="route_info">
                            <div class="route start">
                                <span class="eng"><!--ICN-->${depAirport}</span>
                                <span><!--서울/인천-->${depAirportName}</span>
                            </div>
                            <div class="route end">
                                <span class="eng"><!--KIX-->${arrAirport}</span>
                                <span><!--오사카/간사이-->${arrAirportName}</span>
                            </div>
                        </div>



                        <div class="summary_list">
                            <dl class="fl">

                                <dt><!--날짜/편명-->${flightdateTitle}/${flightnumberTitle}</dt>
                                <dd> ${flightDate} / ${carrierCode}${flightNumber} </dd>

                                <dt><!--출발시간-도착시간/비행시간-->${scheduleTitle}/${journeytimeTitle} </dt>
                                <dd> ${schedule} / ${journeyTime} </dd>

                                <dt><!--운항 구분/실제 운항사-->${directTitle}/${operatingairlineTitle} </dt>
                                <dd> ${segment} / ${operatingAirline} </dd>
                            </dl>
                            <dl class="fr">
                                <dt><!--기내 수하물-->${handLuggageTitle}</dt>
                                <dd>10KG</dd>
                                <dt><!--무료위탁수하물-->${exbgTitle}</dt>
                                <dd>

                                    <!--수하물있는경우-->
                                    {%if exbgsize > 0%}
                                    ${exbgsize}KG
                                        {%if isusaroute%}
                                            X ${exbgpiece}PC
                                        {%/if%}
                                    {%/if%}

                                    <!--무료수하물없음-->
                                    {%if exbgsize == 0%}-{%/if%}

                                </dd>
                                <dt><!--운임 종류-->${faretypeTitle}</dt>
                                <dd>${fareType}</dd>
                            </dl>
                        </div>

                    {%/each%}



                    <div class="passenger_list_wrap">
                        <div class="tit">
                            <h3><!--탑승객별 상세정보-->${passengerInfoTitle}</h3>
                        </div>

                        <div class="passenger_list">
                            <ul>

                               {%each el.pax%}
                               <li class="${paxType}">
                                    <a href="#none" class="title">
                                        <span class="ico_passenger">승객</span>
                                        ${paxName}
                                        <div class="price_wrap">
                                            <span class="unit">${currency}</span>
                                            <span class="price">${subtotal}</span>
											<span class="standard">${standardTitle}</span>
                                        </div>
                                    </a>
                                    <div class="passenger_summary">
                                        <!-- 내역 리스트 -->
                                        <div class="summary_list">
                                            <dl class="fl">
                                                <dt><!--항공운임-->${appliedFareTitle}</dt> <dd>${currency} ${appliedFare}</dd>
                                                <dt><!--유류할증료-->${surchargeTitle}</dt> <dd>${currency} ${surcharge}</dd>
                                                <dt><!--공항시설사용료-->${taxTitle}
													<a href="javascript:taxInfo('1', '1', '${carrierCode}', '${stops}', '${flightNumber}', '${flightDate}', '${depAirport}', '${arrAirport}', '${fareClass}', '${fareTypes}', '${fareBasisCode}', '${baseFare}', '${currency}', '${fareTransactionId}', '1');" class="btn_tooltip alert layer_focus"><span class="blind">${taxTitle}</span></a>
												</dt> <dd>${currency} ${tax}</dd>
                                            </dl>
                                            <dl class="fr">
                                                <dt><!--부가서비스 번들-->${bundleTitle}</dt> <dd>-</dd>
                                                <dt><!--할인 내역-->${discountTitle}</dt> <dd>-</dd>
                                            </dl>
                                        </div>
                                        <!--// 내역 리스트 -->
                                    </div>
                                </li>
                               {%/each%}

                            </ul>
                        </div>

                    </div>


                    <div class="sub_price">
                        <dl>
                            <dt>${subtotalTitle}</dt>
                            <dd>
                                <span class="unit">${currency}</span>
                                <span class="price">${routeAmount}</span>
                            </dd>
                        </dl>
                    </div>




            </div>
        {%/each%}





    </div>

    </script>


    
</html>